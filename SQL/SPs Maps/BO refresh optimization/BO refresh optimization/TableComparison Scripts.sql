 SELECT
	COLUMN_NAME
FROM
  	INFORMATION_SCHEMA.COLUMNS
WHERE
	TABLE_NAME = 'Temp_GroupBenefit'


	--where Year(gp.GroupEffectiveDate) IN ('2019','2018','2020')


	Select abc.BenefitID,InpatientHospitalCopay,PhysicianCopay,SpecialistCopay,EmergencyCopay,PhysicianCoinsurance,SpecialistCoinsurance,EmergencyCoinsurance from Temp_HospitalCopay_IDCardElements_before as abc inner join Benefit b on b.BenefitID = abc.BenefitIDWhere b.EffectiveDate IN ('2019','2018','2020')EXCEPTSelect BenefitID,InpatientHospitalCopay,PhysicianCopay,SpecialistCopay,EmergencyCopay,PhysicianCoinsurance,SpecialistCoinsurance,EmergencyCoinsurance from Temp_HospitalCopay_IDCardElements_afterSelect abc.BenefitID,InpatientHospitalCopay,PhysicianCopay,SpecialistCopay,EmergencyCopay,PhysicianCoinsurance,SpecialistCoinsurance,EmergencyCoinsurance from Temp_HospitalCopay_IDCardElements_before as abc inner join Benefit b on b.BenefitID = abc.BenefitIDWhere b.EffectiveDate IN ('2019','2018','2020')EXCEPTSelect BenefitID,InpatientHospitalCopay,PhysicianCopay,SpecialistCopay,EmergencyCopay,PhysicianCoinsurance,SpecialistCoinsurance,EmergencyCoinsurance from Temp_HospitalCopay_IDCardElements_afterSelect b.BenefitID,InpatientHospitalCopay,PhysicianCopay,SpecialistCopay,EmergencyCopay,PhysicianCoinsurance,SpecialistCoinsurance,EmergencyCoinsurancefrom Temp_HospitalCopay_before as abc inner join Benefit b on b.BenefitID = abc.BenefitIDWhere b.EffectiveDate IN ('2019','2018','2020')Select BenefitID,InpatientHospitalCopay,PhysicianCopay,SpecialistCopay,EmergencyCopay,PhysicianCoinsurance,SpecialistCoinsurance,EmergencyCoinsurancefrom Temp_HospitalCopay_afterSelect GroupID,GroupNumber,GroupEffDate,MedicalPolicy,MedicalName,MedicalVendorName,MedicalEffDate,MedicalTermDate,MedicalFinancialProductCode,MedicalFinancialProduct2Code,MedicalRiskType,MedicalPanel,MedicalLegalEntity,RxPolicy,RxName,RxVendorName,RxEffDate,RxTermDate,RxFinancialProductCode,RxFinancialProduct2Code,RxRiskType,RxPanel,RxLegalEntity,DeluxePolicy,DeluxeName,DeluxeVendorName,DeluxeEffDate,DeluxeTermDate,DeluxeFinancialProductCode,DeluxeFinancialProduct2Code,DeluxeRiskType,DeluxePanel,DeluxeLegalEntity,DentalPolicy,DentalName,DentalVendorName,DentalEffDate,DentalTermDate,DentalFinancialProductCode,DentalFinancialProduct2Code,DentalRiskType,DentalPanel,DentalLegalEntity,VisionPolicy,VisionName,VisionVendorName,VisionEffDate,VisionTermDate,VisionFinancialProductCode,VisionFinancialProduct2Code,VisionRiskType,VisionPanel,VisionLegalEntity,MHSAPolicy,MHSAName,MHSAVendorName,MHSAEffDate,MHSATermDate,MHSAFinancialProductCode,MHSAFinancialProduct2Code,MHSARiskType,MHSAPanel,MHSALegalEntity,ATWPolicy,ATWName,ATWVendorName,ATWEffDate,ATWTermDate,ATWFinancialProductCode,ATWFinancialProduct2Code,ATWRiskType,ATWPanel,ATWLegalEntity,RespitePolicy,RespiteName,RespiteVendorName,RespiteEffDate,RespiteTermDate,RespiteFinancialProductCode,RespiteFinancialProduct2Code,RespiteRiskType,RespitePanel,RespiteLegalEntity,ChiroPolicy,ChiroName,ChiroVendorName,ChiroEffDate,ChiroTermDate,ChiroFinancialProductCode,ChiroFinancialProduct2Code,ChiroRiskType,ChiroPanel,ChiroLegalEntity,ACUPolicy,ACUName,ACUVendorName,ACUEffDate,ACUTermDate,ACUFinancialProductCode,ACUFinancialProduct2Code,ACURiskType,ACUPanel,ACULegalEntity,MassagePolicy,MassageName,MassageVendorName,MassageEffDate,MassageTermDate,MassageFinancialProductCode,MassageFinancialProduct2Code,MassageRiskType,MassagePanel,MassageLegalEntity,FitnessPolicy,FitnessName,FitnessVendorName,FitnessEffDate,FitnessTermDate,FitnessFinancialProductCode,FitnessFinancialProduct2Code,FitnessRiskType,FitnessPanel,FitnessLegalEntity,HearingPolicy,HearingName,HearingVendorName,HearingEffDate,HearingTermDate,HearingFinancialProductCode,HearingFinancialProduct2Code,HearingRiskType,HearingPanel,HearingLegalEntity,PodiatryPolicy,PodiatryName,PodiatryVendorName,PodiatryEffDate,PodiatryTermDate,PodiatryFinancialProductCode,PodiatryFinancialProduct2Code,PodiatryRiskType,PodiatryPanel,PodiatryLegalEntity,NonEmergencyPolicy,NonEmergencyName,NonEmergencyVendorName,NonEmergencyEffDate,NonEmergencyTermDate,NonEmergencyFinancialProductCode,NonEmergencyFinancialProduct2Code,NonEmergencyRiskType,NonEmergencyPanel,NonEmergencyLegalEntity,PHBPolicy,PHBName,PHBVendorName,PHBEffDate,PHBTermDate,PHBFinancialProductCode,PHBFinancialProduct2Code,PHBRiskType,PHBPanel,PHBLegalEntity,NurselinePolicy,NurselineName,NurselineVendorName,NurselineEffDate,NurselineTermDate,NurselineFinancialProductCode,NurselineFinancialProduct2Code,NurselineRiskType,NurselinePanel,NurselineLegalEntity,CaregiverPolicy,CaregiverName,CaregiverVendorName,CaregiverEffDate,CaregiverTermDate,CaregiverFinancialProductCode,CaregiverFinancialProduct2Code,CaregiverRiskType,CaregiverPanel,CaregiverLegalEntity,WellnessPolicy,WellnessName,WellnessVendorName,WellnessEffDate,WellnessTermDate,WellnessFinancialProductCode,WellnessFinancialProduct2Code,WellnessRiskType,WellnessPanel,WellnessLegalEntity,NutritionPolicy,NutritionName,NutritionVendorName,NutritionEffDate,NutritionTermDate,NutritionFinancialProductCode,NutritionFinancialProduct2Code,NutritionRiskType,NutritionPanel,NutritionLegalEntity,PlusPolicy,PlusName,PlusVendorName,PlusEffDate,PlusTermDate,PlusFinancialProductCode,PlusFinancialProduct2Code,PlusRiskType,PlusPanel,PlusLegalEntity,Dental260Policy,Dental260Name,Dental260VendorName,Dental260EffDate,Dental260TermDate,Dental260FinancialProductCode,Dental260FinancialProduct2Code,Dental260RiskType,Dental260Panel,Dental260LegalEntity,Dental466Policy,Dental466Name,Dental466VendorName,Dental466EffDate,Dental466TermDate,Dental466FinancialProductCode,Dental466FinancialProduct2Code,Dental466RiskType,Dental466Panel,Dental466LegalEntity,Dental467Policy,Dental467Name,Dental467VendorName,Dental467EffDate,Dental467TermDate,Dental467FinancialProductCode,Dental467FinancialProduct2Code,Dental467RiskType,Dental467Panel,Dental467LegalEntity,Dental469Policy,Dental469Name,Dental469VendorName,Dental469EffDate,Dental469TermDate,Dental469FinancialProductCode,Dental469FinancialProduct2Code,Dental469RiskType,Dental469Panel,Dental469LegalEntity,DentalGoldPolicy,DentalGoldName,DentalGoldVendorName,DentalGoldEffDate,DentalGoldTermDate,DentalGoldFinancialProductCode,DentalGoldFinancialProduct2Code,DentalGoldRiskType,DentalGoldPanel,DentalGoldLegalEntity,DentalSilverPolicy,DentalSilverName,DentalSilverVendorName,DentalSilverEffDate,DentalSilverTermDate,DentalSilverFinancialProductCode,DentalSilverFinancialProduct2Code,DentalSilverRiskType,DentalSilverPanel,DentalSilverLegalEntity,HighOptionDentalPolicy,HighOptionDentalName,HighOptionDentalVendorName,HighOptionDentalEffDate,HighOptionDentalTermDate,HighOptionDentalFinancialProductCode,HighOptionDentalFinancialProduct2Code,HighOptionDentalRiskType,HighOptionDentalPanel,HighOptionDentalLegalEntity,OptionalDentalPolicy,OptionalDentalName,OptionalDentalVendorName,OptionalDentalEffDate,OptionalDentalTermDate,OptionalDentalFinancialProductCode,OptionalDentalFinancialProduct2Code,OptionalDentalRiskType,OptionalDentalPanel,OptionalDentalLegalEntity,DentalPlatinumPolicy,DentalPlatinumName,DentalPlatinumVendorName,DentalPlatinumEffDate,DentalPlatinumTermDate,DentalPlatinumFinancialProductCode,DentalPlatinumFinancialProduct2Code,DentalPlatinumRiskType,DentalPlatinumPanel,DentalPlatinumLegalEntity from Temp_GroupPolicies_before where YEAR(GroupEffDate) IN ('2018','2019','2020') EXCEPT Select  GroupID,GroupNumber,GroupEffDate,MedicalPolicy,MedicalName,MedicalVendorName,MedicalEffDate,MedicalTermDate,MedicalFinancialProductCode,MedicalFinancialProduct2Code,MedicalRiskType,MedicalPanel,MedicalLegalEntity,RxPolicy,RxName,RxVendorName,RxEffDate,RxTermDate,RxFinancialProductCode,RxFinancialProduct2Code,RxRiskType,RxPanel,RxLegalEntity,DeluxePolicy,DeluxeName,DeluxeVendorName,DeluxeEffDate,DeluxeTermDate,DeluxeFinancialProductCode,DeluxeFinancialProduct2Code,DeluxeRiskType,DeluxePanel,DeluxeLegalEntity,DentalPolicy,DentalName,DentalVendorName,DentalEffDate,DentalTermDate,DentalFinancialProductCode,DentalFinancialProduct2Code,DentalRiskType,DentalPanel,DentalLegalEntity,VisionPolicy,VisionName,VisionVendorName,VisionEffDate,VisionTermDate,VisionFinancialProductCode,VisionFinancialProduct2Code,VisionRiskType,VisionPanel,VisionLegalEntity,MHSAPolicy,MHSAName,MHSAVendorName,MHSAEffDate,MHSATermDate,MHSAFinancialProductCode,MHSAFinancialProduct2Code,MHSARiskType,MHSAPanel,MHSALegalEntity,ATWPolicy,ATWName,ATWVendorName,ATWEffDate,ATWTermDate,ATWFinancialProductCode,ATWFinancialProduct2Code,ATWRiskType,ATWPanel,ATWLegalEntity,RespitePolicy,RespiteName,RespiteVendorName,RespiteEffDate,RespiteTermDate,RespiteFinancialProductCode,RespiteFinancialProduct2Code,RespiteRiskType,RespitePanel,RespiteLegalEntity,ChiroPolicy,ChiroName,ChiroVendorName,ChiroEffDate,ChiroTermDate,ChiroFinancialProductCode,ChiroFinancialProduct2Code,ChiroRiskType,ChiroPanel,ChiroLegalEntity,ACUPolicy,ACUName,ACUVendorName,ACUEffDate,ACUTermDate,ACUFinancialProductCode,ACUFinancialProduct2Code,ACURiskType,ACUPanel,ACULegalEntity,MassagePolicy,MassageName,MassageVendorName,MassageEffDate,MassageTermDate,MassageFinancialProductCode,MassageFinancialProduct2Code,MassageRiskType,MassagePanel,MassageLegalEntity,FitnessPolicy,FitnessName,FitnessVendorName,FitnessEffDate,FitnessTermDate,FitnessFinancialProductCode,FitnessFinancialProduct2Code,FitnessRiskType,FitnessPanel,FitnessLegalEntity,HearingPolicy,HearingName,HearingVendorName,HearingEffDate,HearingTermDate,HearingFinancialProductCode,HearingFinancialProduct2Code,HearingRiskType,HearingPanel,HearingLegalEntity,PodiatryPolicy,PodiatryName,PodiatryVendorName,PodiatryEffDate,PodiatryTermDate,PodiatryFinancialProductCode,PodiatryFinancialProduct2Code,PodiatryRiskType,PodiatryPanel,PodiatryLegalEntity,NonEmergencyPolicy,NonEmergencyName,NonEmergencyVendorName,NonEmergencyEffDate,NonEmergencyTermDate,NonEmergencyFinancialProductCode,NonEmergencyFinancialProduct2Code,NonEmergencyRiskType,NonEmergencyPanel,NonEmergencyLegalEntity,PHBPolicy,PHBName,PHBVendorName,PHBEffDate,PHBTermDate,PHBFinancialProductCode,PHBFinancialProduct2Code,PHBRiskType,PHBPanel,PHBLegalEntity,NurselinePolicy,NurselineName,NurselineVendorName,NurselineEffDate,NurselineTermDate,NurselineFinancialProductCode,NurselineFinancialProduct2Code,NurselineRiskType,NurselinePanel,NurselineLegalEntity,CaregiverPolicy,CaregiverName,CaregiverVendorName,CaregiverEffDate,CaregiverTermDate,CaregiverFinancialProductCode,CaregiverFinancialProduct2Code,CaregiverRiskType,CaregiverPanel,CaregiverLegalEntity,WellnessPolicy,WellnessName,WellnessVendorName,WellnessEffDate,WellnessTermDate,WellnessFinancialProductCode,WellnessFinancialProduct2Code,WellnessRiskType,WellnessPanel,WellnessLegalEntity,NutritionPolicy,NutritionName,NutritionVendorName,NutritionEffDate,NutritionTermDate,NutritionFinancialProductCode,NutritionFinancialProduct2Code,NutritionRiskType,NutritionPanel,NutritionLegalEntity,PlusPolicy,PlusName,PlusVendorName,PlusEffDate,PlusTermDate,PlusFinancialProductCode,PlusFinancialProduct2Code,PlusRiskType,PlusPanel,PlusLegalEntity,Dental260Policy,Dental260Name,Dental260VendorName,Dental260EffDate,Dental260TermDate,Dental260FinancialProductCode,Dental260FinancialProduct2Code,Dental260RiskType,Dental260Panel,Dental260LegalEntity,Dental466Policy,Dental466Name,Dental466VendorName,Dental466EffDate,Dental466TermDate,Dental466FinancialProductCode,Dental466FinancialProduct2Code,Dental466RiskType,Dental466Panel,Dental466LegalEntity,Dental467Policy,Dental467Name,Dental467VendorName,Dental467EffDate,Dental467TermDate,Dental467FinancialProductCode,Dental467FinancialProduct2Code,Dental467RiskType,Dental467Panel,Dental467LegalEntity,Dental469Policy,Dental469Name,Dental469VendorName,Dental469EffDate,Dental469TermDate,Dental469FinancialProductCode,Dental469FinancialProduct2Code,Dental469RiskType,Dental469Panel,Dental469LegalEntity,DentalGoldPolicy,DentalGoldName,DentalGoldVendorName,DentalGoldEffDate,DentalGoldTermDate,DentalGoldFinancialProductCode,DentalGoldFinancialProduct2Code,DentalGoldRiskType,DentalGoldPanel,DentalGoldLegalEntity,DentalSilverPolicy,DentalSilverName,DentalSilverVendorName,DentalSilverEffDate,DentalSilverTermDate,DentalSilverFinancialProductCode,DentalSilverFinancialProduct2Code,DentalSilverRiskType,DentalSilverPanel,DentalSilverLegalEntity,HighOptionDentalPolicy,HighOptionDentalName,HighOptionDentalVendorName,HighOptionDentalEffDate,HighOptionDentalTermDate,HighOptionDentalFinancialProductCode,HighOptionDentalFinancialProduct2Code,HighOptionDentalRiskType,HighOptionDentalPanel,HighOptionDentalLegalEntity,OptionalDentalPolicy,OptionalDentalName,OptionalDentalVendorName,OptionalDentalEffDate,OptionalDentalTermDate,OptionalDentalFinancialProductCode,OptionalDentalFinancialProduct2Code,OptionalDentalRiskType,OptionalDentalPanel,OptionalDentalLegalEntity,DentalPlatinumPolicy,DentalPlatinumName,DentalPlatinumVendorName,DentalPlatinumEffDate,DentalPlatinumTermDate,DentalPlatinumFinancialProductCode,DentalPlatinumFinancialProduct2Code,DentalPlatinumRiskType,DentalPlatinumPanel,DentalPlatinumLegalEntityfrom Temp_GroupPolicies_after--IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Temp_GroupBenefit]') AND type in (N'U'))    
--DELETE FROM [dbo].[Temp_GroupBenefit]    
--			Where GroupID IN (Select TG.GroupID from  [dbo].[Temp_GroupBenefit]  TG
--			INNER JOIN [Group] gp ON  gp.GroupID = TG.GroupID  
--			where YEAR(gp.EffectiveDate ) IN (SELECT Years FROM dbo.udfGetPrevCurrNextYears()) )


Select 
PlanID,abc.GroupID,PlanTypeID,MedicalPremium,DentalPremium,VisionPremium,RxPremium,MHSAPremium,DeluxePremium,ATWPremium,RespitePremium,ChiroPremium,ACUPremium,MassagePremium,FitnessPremium,HearingPremium,PodiatryPremium,NonEmergencyPremium,PHBPremium,NurselinePremium,CaregiverPremium,WellnessPremium,NutritionPremium,PlusPremium,Dental260Premium,Dental466Premium,Dental467Premium,Dental469Premium,DentalGoldPremium,DentalSilverPremium,HighOptionDentalPremium,OptionalDentalPremium,DentalPlatinumPremium,BrandName,DrugCoverageType,PlanLongName,IsPassportFlag,IsRDSFlag,IsCostShareIndicator,IsOpenAccess,IsGateKeeper,IsSpecialistSelfReferral,IDCardEmployerNamefrom Temp_GroupBenefit_before abc inner join [Group] gp on gp.GroupID = abc.GroupIDwhere Year(gp.EffectiveDate) IN ('2019','2018','2020')EXCEPTSelect 
PlanID,GroupID,PlanTypeID,MedicalPremium,DentalPremium,VisionPremium,RxPremium,MHSAPremium,DeluxePremium,ATWPremium,RespitePremium,ChiroPremium,ACUPremium,MassagePremium,FitnessPremium,HearingPremium,PodiatryPremium,NonEmergencyPremium,PHBPremium,NurselinePremium,CaregiverPremium,WellnessPremium,NutritionPremium,PlusPremium,Dental260Premium,Dental466Premium,Dental467Premium,Dental469Premium,DentalGoldPremium,DentalSilverPremium,HighOptionDentalPremium,OptionalDentalPremium,DentalPlatinumPremium,BrandName,DrugCoverageType,PlanLongName,IsPassportFlag,IsRDSFlag,IsCostShareIndicator,IsOpenAccess,IsGateKeeper,IsSpecialistSelfReferral,IDCardEmployerNamefrom Temp_GroupBenefit_after